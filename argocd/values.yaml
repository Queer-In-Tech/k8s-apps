global:
  domain: argocd.queerintech.org

server:
  httproute:
    enabled: true
    hostnames:
    - argocd.queerintech.org
    parentRefs:
      - group: gateway.networking.k8s.io	
        kind: Gateway
        name: traefik-gateway
        namespace: traefik

configs:
  params: 
    server.insecure: true
  cm:
    oidc.config: |
      name: Authentik
      issuer: https://auth.queerintech.org/application/o/argocd/
      clientID: argocd
      clientSecret: $argocd-authentik:secret
      skipAudienceCheckWhenTokenHasNoAudience: true
      requestedScopes: ["openid", "profile", "email", "groups"]
      requestedIDTokenClaims: {"groups": {"essential": true}}
      enablePKCEAuthentication: true
  rbac:
    policy.csv: |
      p, role:org-admin, applications, *, */*, allow
      p, role:org-admin, clusters, get, *, allow
      p, role:org-admin, repositories, *, *, allow
      p, role:org-admin, logs, get, *, allow
      p, role:org-admin, exec, create, */*, allow
      g, Administrators, role:org-admin
